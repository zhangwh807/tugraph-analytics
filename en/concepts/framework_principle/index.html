<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-en docs-version-current docs-doc-page docs-doc-id-concepts/framework_principle" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Framework Architecture | TuGraph Analytics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://liukaiming-alipay.github.io/tugraph-analytics/en/concepts/framework_principle"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-en-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-en-current"><meta data-rh="true" property="og:title" content="Framework Architecture | TuGraph Analytics"><meta data-rh="true" name="description" content="The architecture of GeaFlow Framework is shown in the following diagram:"><meta data-rh="true" property="og:description" content="The architecture of GeaFlow Framework is shown in the following diagram:"><link data-rh="true" rel="icon" href="https://mdn.alipayobjects.com/huamei_qcdryc/afts/img/A*AbamQ5lxv0IAAAAAAAAAAAAADgOBAQ/original"><link data-rh="true" rel="canonical" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/concepts/framework_principle"><link data-rh="true" rel="alternate" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/concepts/framework_principle" hreflang="en"><link data-rh="true" rel="alternate" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/concepts/framework_principle" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HO4M21RAQI-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/tugraph-analytics/blog/rss.xml" title="TuGraph Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tugraph-analytics/blog/atom.xml" title="TuGraph Analytics Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="TuGraph Analytics" href="/tugraph-analytics/opensearch.xml">

<meta name="algolia-site-verification" content="4AB782AC2021573E"><link rel="stylesheet" href="/tugraph-analytics/assets/css/styles.58f3a227.css">
<script src="/tugraph-analytics/assets/js/runtime~main.b6dda648.js" defer="defer"></script>
<script src="/tugraph-analytics/assets/js/main.85c50c04.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/tugraph-analytics/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="docsearch-wrapper" style="display:flex;justify-content:center;flex-direction:column"><div style="display:flex;justify-content:space-between;margin-bottom:8px"><div class="itemWrapper"><div class="titleBlock"><span class="titleText">TuGraph Analytics</span><div class="downIcon"></div></div><div class="contentArea"><span id="engineDescription">Streaming Graph Computing Engine</span></div></div><div class="searchWrapper" aria-describedby=":R4llaqh:"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/guide">Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/quick_start/quick_start">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/tugraph-analytics/en/concepts/glossary">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/concepts/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/concepts/dsl_principle">DSL Principle Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tugraph-analytics/en/concepts/framework_principle">Framework Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/concepts/state_principle">Introduction to State Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/concepts/console_principle">GeaFlow Console Platform</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/application-development/api/overview">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/deploy/install_guide">Deployment</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/contribution">Contribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/contacts">Contacts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/thanks">Thanks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/reference/vs_join">Reference</a></div></li></ul></nav></div></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/tugraph-analytics/en/guide"><div style="color:#1a1b2572">Docs</div></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Concepts</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Framework Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Framework Architecture</h1></header>
<p>The architecture of GeaFlow Framework is shown in the following diagram:</p>
<p><img decoding="async" loading="lazy" alt="framework_arch" src="/tugraph-analytics/assets/images/framework_arch_new-b50a6933a6a3c01de60ba7cc4e848c9f.png" width="2236" height="674" class="img_ev3q"></p>
<ul>
<li><strong>High Level API</strong>: GeaFlow adapts to heterogeneous distributed execution environments (K8S, Ray, Local) through the Environment interface. It encapsulates the user&#x27;s data processing flow using Pipelines and abstracts the stream processing (unbounded window) and batch processing (bounded window) using Windows. The Graph interface provides computation APIs on static graphs and dynamic graphs (streaming graphs), such as append/snapshot/compute/traversal, while the Stream interface provides unified stream and batch processing APIs, such as map/reduce/join/keyBy, etc.</li>
<li><strong>Logical Execution Plan</strong>: The logical execution plan information is encapsulated in the PipelineGraph object. It organizes the high-level API operators in a directed acyclic graph. Operators are categorized into 5 types: SourceOperator for data source loading, OneInputOperator/TwoInputOperator for traditional data processing, and IteratorOperator for static/dynamic graph computation. The vertices (PipelineVertex) in the DAG store crucial information about operators, such as type, parallelism, and operator functions, while the edges (PipelineEdge) record key information about data shuffling, such as partition rules (forward/broadcast/key), and encoders/decoders.</li>
<li><strong>Physical Execution Plan</strong>: The physical execution plan information is encapsulated in the ExecutionGraph object, which supports a two-level nested structure to schedule subgraphs that can be executed in pipelined manner. The example execution plan DAG in the graph is partitioned into three subgraph structures for execution.</li>
<li><strong>Scheduler</strong>: GeaFlow designs a Cycle-based scheduler (CycleScheduler) to achieve unified scheduling for stream, batch, and graph processing. The scheduling process is triggered by an event-driven model. Each subgraph in the physical execution plan is transformed into an ExecutionCycle object. The scheduler sends events to the head node (Head) of the cycle and receives events sent back from the tail node (Tail) to form a complete scheduling loop. For stream processing, each cycle scheduling round completes the processing of a window of data and continues indefinitely. For batch processing, the entire cycle scheduling is executed only once. For graph processing, each cycle scheduling round completes one iteration of graph computation.</li>
<li><strong>Runtime Components</strong>: GeaFlow&#x27;s runtime launches the Client, Master, Driver, and Container components. When the Client submits a Pipeline to the Driver, it triggers the construction of the execution plan, task allocation (resources are provided by ResourceManagement), and scheduler. Each Container can run multiple Worker components, and data exchange between different Worker components is done through the Shuffle module. All workers need to regularly send heartbeats (HeartbeatManagement) to the Master and report runtime metric information to the time-series database. Additionally, GeaFlow&#x27;s runtime provides fault tolerance mechanisms (FailOver) to continue execution in case of exceptions/interruptions.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="computing-engine">Computing Engine<a href="#computing-engine" class="hash-link" aria-label="Direct link to Computing Engine" title="Direct link to Computing Engine">​</a></h2>
<p>The core modules of GeaFlow computing engine mainly include execution plan generation and optimization, unified cycle scheduling, and worker runtime execution. The following is an introduction to these core modules.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-plan">Execution Plan<a href="#execution-plan" class="hash-link" aria-label="Direct link to Execution Plan" title="Direct link to Execution Plan">​</a></h3>
<p>For the submitted PipelineTask in the stream graph scenario, a unified execution plan model is constructed, and different execution modes are aggregated together as a group for scheduling to provide a unified execution unit.</p>
<ul>
<li>
<p>PipelineGraph
The PipelineGraph is constructed from the PipelineTask submitted by the user&#x27;s API. The user&#x27;s API is transformed into an operator corresponding to a vertex, and the data dependencies between vertices are represented by edges. The PipelineGraph only constructs a structured logical execution plan from the API and does not have the physical execution semantics.</p>
</li>
<li>
<p>ExecutionGraph
The ExecutionGraph aggregates a group of executable vertices together to build the corresponding ExecutionGroup based on different calculation models. Each group represents an independent schedulable unit. A group can be built from one or more vertices and can be considered as a small execution plan. The data exchange within the group is done in pipeline mode, while batch mode is used between groups. The group describes the specific execution mode, supports nesting, can be executed once or multiple times, and can execute data from one or more windows. The group is shown in the following figure. ExecutionGroup is ultimately transformed into the basic unit cycle for scheduling and execution.
<img decoding="async" loading="lazy" alt="group.jpg" src="/tugraph-analytics/assets/images/framework_dag-79bc6c714140a269c92391ae58ab3c8e.jpeg" width="531" height="862" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling-model">Scheduling Model<a href="#scheduling-model" class="hash-link" aria-label="Direct link to Scheduling Model" title="Direct link to Scheduling Model">​</a></h3>
<p>Scheduling generates scheduling basic units cycles based on ExecutionGroup defined in ExecutionGraph. A cycle is a basic unit that can be executed repeatedly and contains descriptions of input, intermediate calculations, data exchange, and output. The scheduling and execution process is mainly as follows:</p>
<ol>
<li>Divide the execution plan into a group of cycles. If there is no data dependency between cycles, they can be executed in series or in parallel.</li>
<li>According to the scheduling data policy of the cycle, the cycle is scheduled and executed in order.</li>
<li>Wait until all cycles are executed, and return the scheduling execution results.
Each cycle contains a group of executable ExecutionTasks, and each task can be distributed for remote execution. All execution tasks in a cycle can be divided as follows:
Head task: the starting point of the cycle data stream. The scheduling sends an execution event to the head task, reads data from the source or the output of the previous cycle, processes it, and sends it to the downstream.
Tail task: the end of the cycle data stream. After processing the data, the tail task sends an event to the scheduler, indicating that a round of calculation is completed.
Other non-head/tail tasks: intermediate execution tasks that receive input data from upstream, process it, and send it directly to the downstream.
The scheduling and execution process of the cycle is like a &quot;loop,&quot; continuously sending events to the head and receiving return events from the tail, as shown in the following figure. The scheduling initializes the scheduling state according to the type of the cycle, and the scheduling process is also a process of state transition. Based on the received event, the scheduling decides the type of event to be sent to the head for the next round.
<img decoding="async" loading="lazy" alt="scheduler.jpg" src="/tugraph-analytics/assets/images/framework_cyle-39d7a5210e7f041319d7da93a263c84f.jpeg" width="850" height="906" class="img_ev3q"></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-execution">Runtime Execution<a href="#runtime-execution" class="hash-link" aria-label="Direct link to Runtime Execution" title="Direct link to Runtime Execution">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="overall-introduction">Overall Introduction<a href="#overall-introduction" class="hash-link" aria-label="Direct link to Overall Introduction" title="Direct link to Overall Introduction">​</a></h4>
<p>Runtime module is responsible for the specific computation and execution of all GeaFlow mode tasks, including streaming-batch, static/dynamic graph. Its entire worker process is as follows:</p>
<ol>
<li>Scheduler is responsible for sending various types of events to Container for processing.</li>
<li>Dispatcher (inherited from AbstractTaskRunner) is responsible for receiving events sent by Scheduler and distributing them to specified TaskRunners according to their workerId.</li>
<li>TaskRunner (also inherited from AbstractTaskRunner) is responsible for fetching TASK(Event) from taskQueue, and the specific Event will be processed by Task. The whole lifecycle of Task includes creation, processing and ending. For abnormal Tasks, they can be directly interrupted.
a. Task creation and initialization will be completed according to CreateTaskEvent. The lifecycle of Task will end according to DestroyTaskEvent.
b. Other types of events will be completed on the semantic level of specific calculation through execute() method of corresponding CommandEvent. For example, according to InitCycleEvent, Worker will build upstream and downstream dependencies. According to LaunchSourceEvent, Worker will trigger source to start reading data, etc.
<img decoding="async" loading="lazy" alt="undefined" src="/tugraph-analytics/assets/images/framework_scheduler-49a78ec34bdc932f5db2e0868a5a88a0.png" width="779" height="772" class="img_ev3q">
The core data structure in the current TaskContext includes the Worker responsible for executing computations, the FetchService responsible for asynchronous data reading from upstream nodes to downstream, and the EmitterService responsible for outputting data generated by the execution Worker to downstream.</li>
</ol>
<ul>
<li>Worker: mainly responsible for aligning and processing data in the flow graph, and calling back the corresponding DoneEvent to Scheduler after each batch processing, so that Scheduler can perform subsequent scheduling logic according to the DoneEvent.</li>
<li>FetchService: responsible for asynchronously pulling data from the upstream channel, and putting it into the worker processing queue through the Listener registered by the worker.</li>
<li>EmitterService: responsible for partition writing the data generated by the Worker into the corresponding Channel.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="command-event">Command Event<a href="#command-event" class="hash-link" aria-label="Direct link to Command Event" title="Direct link to Command Event">​</a></h4>
<ul>
<li>Command Events can be divided into two types:
<ul>
<li>Normal Command Events, which do not have specific execute logic and are usually used to trigger the start and end of Task or Cycle lifecycles.</li>
<li>Executable Command Events, which have their own execute logic, such as Cycle initialization, data reading in the Source node, computation in the processing node, and cleanup after the Cycle ends.</li>
</ul>
</li>
<li>In the scheduling module, various types of events will be constructed into a State Machine for the lifecycle management of the entire scheduling task.</li>
<li>Developers can extend Events and implement corresponding execute logic according to design needs, and add them to the State Machine. Then Scheduler can automatically schedule and execute them as expected.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fault-tolerance-and-exception-recovery">Fault Tolerance And Exception Recovery<a href="#fault-tolerance-and-exception-recovery" class="hash-link" aria-label="Direct link to Fault Tolerance And Exception Recovery" title="Direct link to Fault Tolerance And Exception Recovery">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-component-fault-tolerance">Cluster Component Fault Tolerance<a href="#cluster-component-fault-tolerance" class="hash-link" aria-label="Direct link to Cluster Component Fault Tolerance" title="Direct link to Cluster Component Fault Tolerance">​</a></h4>
<p>For all runtime component processes, such as master/driver/container, they are initialized and run based on context. When creating a new process, the context required by the process is constructed first, and each process persists the context during initialization. When a process restarts abnormally, the context is recovered first, and then the process is re-initialized based on the context.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="job-exception-recovery">Job Exception Recovery<a href="#job-exception-recovery" class="hash-link" aria-label="Direct link to Job Exception Recovery" title="Direct link to Job Exception Recovery">​</a></h4>
<p><img decoding="async" loading="lazy" alt="undefined" src="/tugraph-analytics/assets/images/framework_failover-2d70f7410d0ce11cbd020578d308d037.jpeg" width="955" height="817" class="img_ev3q"></p>
<ul>
<li>
<p>Distributed snapshot of job
The Scheduler determines the new windowId to be sent to the running tasks based on its current scheduling state, triggering the computation of the new window. When each operator completes the calculation of the corresponding window, if a snapshot of the current window context needs to be taken, the corresponding state within the operator will be persisted to storage.
Finally, after the Scheduler receives the message that all tasks for a certain window have completed, it will take a snapshot of the scheduling metadata as needed and persist it. Only then is the processing of this window considered finished. When the Scheduler and the operator recover to this window context, they can continue to execute based on that window.</p>
</li>
<li>
<p>Snapshot persistence
When a snapshot is taken after a window calculation is completed, the storage method for the snapshot can be chosen. Currently, MEMORY, ROCKSDB, and JDBC are available.</p>
</li>
<li>
<p>State recovery
The snapshot storage is distributed, with each component, Scheduler, and operator storing and persisting their own data. During recovery, the Scheduler first recovers the windowId that was last completed from the storage, and then the Scheduler context is restored to the snapshot corresponding to that windowId. Then, a rollback command is sent to all workers, and each worker is restored to the specified window context. Finally, the Scheduler begins sending execution tasks again, continuing to execute based on the recovered state.</p>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/tugraph-analytics/en/concepts/dsl_principle"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DSL Principle Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tugraph-analytics/en/concepts/state_principle"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction to State Principles</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#computing-engine" class="table-of-contents__link toc-highlight">Computing Engine</a><ul><li><a href="#execution-plan" class="table-of-contents__link toc-highlight">Execution Plan</a></li><li><a href="#scheduling-model" class="table-of-contents__link toc-highlight">Scheduling Model</a></li><li><a href="#runtime-execution" class="table-of-contents__link toc-highlight">Runtime Execution</a></li><li><a href="#fault-tolerance-and-exception-recovery" class="table-of-contents__link toc-highlight">Fault Tolerance And Exception Recovery</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>