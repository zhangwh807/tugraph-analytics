<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-en docs-version-current docs-doc-page docs-doc-id-application-development/api/stream/process" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Process Introduction | TuGraph Analytics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://liukaiming-alipay.github.io/tugraph-analytics/en/application-development/api/stream/process"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-en-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-en-current"><meta data-rh="true" property="og:title" content="Process Introduction | TuGraph Analytics"><meta data-rh="true" name="description" content="GeaFlow provides a series of Process APIs to the public, which are similar to general stream batch but not identical. As already introduced in the Source API, the source constructed from it has window semantics. Therefore, all GeaFlow Process APIs also have window semantics."><meta data-rh="true" property="og:description" content="GeaFlow provides a series of Process APIs to the public, which are similar to general stream batch but not identical. As already introduced in the Source API, the source constructed from it has window semantics. Therefore, all GeaFlow Process APIs also have window semantics."><link data-rh="true" rel="icon" href="https://mdn.alipayobjects.com/huamei_qcdryc/afts/img/A*AbamQ5lxv0IAAAAAAAAAAAAADgOBAQ/original"><link data-rh="true" rel="canonical" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/application-development/api/stream/process"><link data-rh="true" rel="alternate" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/application-development/api/stream/process" hreflang="en"><link data-rh="true" rel="alternate" href="https://liukaiming-alipay.github.io/tugraph-analytics/en/application-development/api/stream/process" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HO4M21RAQI-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/tugraph-analytics/blog/rss.xml" title="TuGraph Analytics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tugraph-analytics/blog/atom.xml" title="TuGraph Analytics Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="TuGraph Analytics" href="/tugraph-analytics/opensearch.xml">

<meta name="algolia-site-verification" content="4AB782AC2021573E"><link rel="stylesheet" href="/tugraph-analytics/assets/css/styles.58f3a227.css">
<script src="/tugraph-analytics/assets/js/runtime~main.b6dda648.js" defer="defer"></script>
<script src="/tugraph-analytics/assets/js/main.85c50c04.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/tugraph-analytics/"></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="docsearch-wrapper" style="display:flex;justify-content:center;flex-direction:column"><div style="display:flex;justify-content:space-between;margin-bottom:8px"><div class="itemWrapper"><div class="titleBlock"><span class="titleText">TuGraph Analytics</span><div class="downIcon"></div></div><div class="contentArea"><span id="engineDescription">Streaming Graph Computing Engine</span></div></div><div class="searchWrapper" aria-describedby=":R4llaqh:"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/guide">Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/quick_start/quick_start">Quick Start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/concepts/glossary">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/tugraph-analytics/en/application-development/api/overview">Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/tugraph-analytics/en/application-development/api/overview">API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/application-development/api/overview">API Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/tugraph-analytics/en/application-development/api/stream/source">Stream</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/application-development/api/stream/source">Source Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tugraph-analytics/en/application-development/api/stream/process">Process Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/application-development/api/stream/sink">Sink Introduction</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tugraph-analytics/en/application-development/api/graph/traversal">Graph</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tugraph-analytics/en/application-development/dsl/overview">DSL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tugraph-analytics/en/application-development/connector/common">Connector</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-analytics/en/application-development/chat_guide">Text2GQL Syntax Manual</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/deploy/install_guide">Deployment</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/contribution">Contribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/contacts">Contacts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-analytics/en/thanks">Thanks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-analytics/en/reference/vs_join">Reference</a></div></li></ul></nav></div></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/tugraph-analytics/en/guide"><div style="color:#1a1b2572">Docs</div></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Stream</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Process Introduction</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Process Introduction</h1></header>
<p>GeaFlow provides a series of Process APIs to the public, which are similar to general stream batch but not identical. As already introduced in the Source API, the source constructed from it has window semantics. Therefore, all GeaFlow Process APIs also have window semantics.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interface">Interface<a href="#interface" class="hash-link" aria-label="Direct link to Interface" title="Direct link to Interface">​</a></h2>























































<table><thead><tr><th>API</th><th>Interface Description</th><th>Input Parameter Description</th></tr></thead><tbody><tr><td><r> PWindowStream<r> map(MapFunction&lt;T, R&gt; mapFunction)</r></r></td><td>By implementing mapFunction, input T can be transformed into R and output to downstream</td><td>mapFunction：Users define their own conversion logic, T represents input type, and R represents output type</td></tr><tr><td>PWindowStream<t> filter(FilterFunction<t> filterFunction)</t></t></td><td>&quot;By implementing filterFunction, T that does not meet the requirements can be filtered out</td><td>filterFunction：Users define their own filter logic, T represents input type</td></tr><tr><td><r> PWindowStream<r> flatMap(FlatMapFunction&lt;T, R&gt; flatMapFunction)</r></r></td><td>By implementing flatMapFunction, one T input can generate n R outputs and output to downstream</td><td>flatMapFunction：Users implement their own logic, T represents input type, and R represents output type</td></tr><tr><td>PWindowStream<t> union(PStream<t> uStream)</t></t></td><td>Used to implement merging two input streams</td><td>uStream：Input stream, T represents the input stream type</td></tr><tr><td>PWindowBroadcastStream<t> broadcast()</t></td><td>Broadcasting data streams</td><td>No</td></tr><tr><td><key> PWindowKeyStream&lt;KEY, T&gt; keyBy(KeySelector&lt;T, KEY&gt; selectorFunction)</key></td><td>Shuffle the input records according to the KEY and output them</td><td>selectorFunction：Users define their own logic for selecting KEY, T represents record input type, and KEY represents the defined KEY type</td></tr><tr><td>PWindowStream<t> reduce(ReduceFunction<t> reduceFunction)</t></t></td><td>Support two modes of reduce. For batch, it is based on the reduction and aggregation calculation within the current window. For dynamic streams, it is based on the global reduction and aggregation calculation of dynamic increment (equivalent to Flink&#x27;s stream aggregation calculation). By default, GeaFLOW adopts dynamic stream aggregation calculation semantics. If batch semantics are needed, users can enable them through parameters</td><td>reduceFunction：Users define their own reduce aggregation logic. T indicates the input record type</td></tr><tr><td>&lt;ACC, OUT&gt; PWindowStream<out> aggregate(AggregateFunction&lt;T, ACC, OUT&gt; aggregateFunction)</out></td><td>Support two modes of aggregate. For batch processing, it is based on the aggregate calculation within the current window; while for stream processing, it is based on the global aggregate calculation of dynamic increment (equivalent to Flink&#x27;s stream aggregation calculation). By default, GeaFlow adopts stream aggregate calculation semantics. If batch semantics are needed, users can enable them through parameters</td><td>aggregateFunction：Users define their own aggregation calculation logic, T represents input type, ACC represents aggregation value type, and OUT represents output type</td></tr><tr><td>PIncStreamView<t> materialize()</t></td><td>Used to identify whether the aggregation calculation is based on streaming or batch processing. By default, there is no need to call this interface</td><td>No</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h2>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StreamUnionPipeline implements Serializable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Logger LOGGER = LoggerFactory.getLogger(StreamUnionPipeline.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static final String RESULT_FILE_PATH = &quot;./target/tmp/data/result/union&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static final String REF_FILE_PATH = &quot;data/reference/union&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static final String SPLIT = &quot;,&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Get execution environment.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Environment environment = EnvironmentFactory.onLocalEnvironment();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Perform job submission.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IPipelineResult&lt;?&gt; result = submit(environment);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result.get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Wait for execution to complete.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        environment.shutdown();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static IPipelineResult&lt;?&gt; submit(Environment environment) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Pipeline pipeline = PipelineFactory.buildPipeline(environment);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Configuration envConfig = environment.getEnvironmentContext().getConfig();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        envConfig.getConfigMap().put(FileSink.OUTPUT_DIR, RESULT_FILE_PATH);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pipeline.submit(new PipelineTask() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public void execute(IPipelineTaskContext pipelineTaskCxt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Configuration conf = pipelineTaskCxt.getConfig();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PWindowSource&lt;String&gt; streamSource =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    pipelineTaskCxt.buildSource(new FileSource&lt;String&gt;(&quot;data/input&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        + &quot;/email_edge&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Collections::singletonList) {}, SizeTumblingWindow.of(5000));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                PWindowSource&lt;String&gt; streamSource2 =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    pipelineTaskCxt.buildSource(new FileSource&lt;String&gt;(&quot;data/input&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        + &quot;/email_edge&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Collections::singletonList) {}, SizeTumblingWindow.of(5000));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SinkFunction&lt;String&gt; sink = ExampleSinkFunctionFactory.getSinkFunction(conf);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                streamSource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Union streamSource with streamSource2。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .union(streamSource2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Parse each message according to the SPLIT delimiter, and distribute each data downstream.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .flatMap(new FlatMapFunction&lt;String, Long&gt;() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        public void flatMap(String value, Collector collector) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            String[] records = value.split(SPLIT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            for (String record : records) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                collector.partition(Long.valueOf(record));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Build tuple.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .map(p -&gt; Tuple.of(p, p))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Shuffle according to the tuple as the key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .keyBy(p -&gt; p)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Perform dynamic stream incremental computation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .aggregate(new AggFunc())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Specify the parallelism for aggregation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .withParallelism(conf.getInteger(AGG_PARALLELISM))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .map(v -&gt; String.format(&quot;%s&quot;, v))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .sink(sink)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .withParallelism(conf.getInteger(SINK_PARALLELISM));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return pipeline.execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static class AggFunc implements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AggregateFunction&lt;Tuple&lt;Long, Long&gt;, Tuple&lt;Long, Long&gt;, Tuple&lt;Long, Long&gt;&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Initialize and create Accumulator.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public Tuple&lt;Long, Long&gt; createAccumulator() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Tuple.of(0L, 0L);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add the value to the accumulator.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void add(Tuple&lt;Long, Long&gt; value, Tuple&lt;Long, Long&gt; accumulator) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            accumulator.setF0(value.f0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            accumulator.setF1(value.f1 + accumulator.f1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Get Tuple2 result from accumulator.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public Tuple&lt;Long, Long&gt; getResult(Tuple&lt;Long, Long&gt; accumulator) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return Tuple.of(accumulator.f0, accumulator.f1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public Tuple&lt;Long, Long&gt; merge(Tuple&lt;Long, Long&gt; a, Tuple&lt;Long, Long&gt; b) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/tugraph-analytics/en/application-development/api/stream/source"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Source Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tugraph-analytics/en/application-development/api/stream/sink"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sink Introduction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#interface" class="table-of-contents__link toc-highlight">Interface</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>