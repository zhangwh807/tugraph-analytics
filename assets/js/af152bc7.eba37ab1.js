"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4962],{7352:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var t=s(4848),r=s(8453);const l={},a="Pulsar Connector\u4ecb\u7ecd",i={id:"application-development/connector/pulsar",title:"Pulsar Connector\u4ecb\u7ecd",description:"GeaFlow \u652f\u6301\u4ece Pulsar \u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5411 Pulsar \u5199\u5165\u6570\u636e\u3002\u76ee\u524d\u652f\u6301\u7684 Pulsar \u7248\u672c\u4e3a 2.8.1\u3002",source:"@site/../docs-cn/source/5.application-development/3.connector/9.pulsar.md",sourceDirName:"5.application-development/3.connector",slug:"/application-development/connector/pulsar",permalink:"/tugraph-analytics/zh/application-development/connector/pulsar",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hudi Connector\u4ecb\u7ecd",permalink:"/tugraph-analytics/zh/application-development/connector/hudi"},next:{title:"\u81ea\u5b9a\u4e49Connector",permalink:"/tugraph-analytics/zh/application-development/connector/udc"}},o={},d=[{value:"\u8bed\u6cd5",id:"\u8bed\u6cd5",level:2},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:2},{value:"\u793a\u4f8b1",id:"\u793a\u4f8b1",level:2},{value:"\u793a\u4f8b2",id:"\u793a\u4f8b2",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"pulsar-connector\u4ecb\u7ecd",children:"Pulsar Connector\u4ecb\u7ecd"})}),"\n",(0,t.jsx)(e.p,{children:"GeaFlow \u652f\u6301\u4ece Pulsar \u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5e76\u5411 Pulsar \u5199\u5165\u6570\u636e\u3002\u76ee\u524d\u652f\u6301\u7684 Pulsar \u7248\u672c\u4e3a 2.8.1\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u8bed\u6cd5",children:"\u8bed\u6cd5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE pulsar_table (\n  id BIGINT,\n  name VARCHAR,\n  age INT\n) WITH (\n\ttype='pulsar',\n    `geaflow.dsl.pulsar.servers` = 'localhost',\n    `geaflow.dsl.pulsar.port` = '6650',\n    `geaflow.dsl.pulsar.topic` = 'persistent://test/test_pulsar_connector/topic_read',\n    `geaflow.dsl.pulsar.subscriptionInitialPosition` = 'latest'\n)\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u53c2\u6570\u540d"}),(0,t.jsx)(e.th,{children:"\u662f\u5426\u5fc5\u987b"}),(0,t.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"geaflow.dsl.pulsar.servers"}),(0,t.jsx)(e.td,{children:"\u662f"}),(0,t.jsx)(e.td,{children:"Pulsar \u7684\u5f15\u5bfc\u670d\u52a1\u5668\uff08bootstrap\uff09\u5217\u8868"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"geaflow.dsl.pulsar.port"}),(0,t.jsx)(e.td,{children:"\u662f"}),(0,t.jsx)(e.td,{children:"Pulsar \u7684\u5f15\u5bfc\u670d\u52a1\u5668\uff08bootstrap\uff09\u7aef\u53e3\u53f7"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"geaflow.dsl.pulsar.topic"}),(0,t.jsx)(e.td,{children:"\u662f"}),(0,t.jsx)(e.td,{children:"Pulsar topic"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"geaflow.dsl.pulsar.subscriptionInitialPosition"}),(0,t.jsx)(e.td,{children:"\u5426"}),(0,t.jsx)(e.td,{children:"Pulsar\u6d88\u8d39\u7684\u521d\u59cb\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662f 'latest', \u53ef\u9009\u62e9 'earliest\u2018"})]})]})]}),"\n",(0,t.jsx)(e.p,{children:"\u6ce8\u610f\uff1apulsar connector\u4e0d\u80fd\u6307\u5b9a\u4e00\u4e2a\u5206\u533atopic\uff0c \u5982\u679c\u4f60\u8981\u6d88\u8d39\u67d0\u4e2a\u5206\u533a\u7684\u6d88\u606f\uff0c\u8bf7\u9009\u62e9\u5206\u533atopic\u7684\u5b50topic\u540d\u79f0\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b1",children:"\u793a\u4f8b1"}),"\n",(0,t.jsxs)(e.p,{children:["\u793a\u4f8b1\u662f\u4ecepulsar\u4ece",(0,t.jsx)(e.code,{children:"topic_read"}),"\u4e2d\u8bfb\u53d6\u6570\u636e\u5e76\u4e14\u5c06\u6570\u636e\u5199\u5165",(0,t.jsx)(e.code,{children:"topic_write"}),"\u4e2d\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE pulsar_source (\n    id BIGINT,\n    name VARCHAR,\n    age INT\n) WITH (\n    type='pulsar',\n    `geaflow.dsl.pulsar.servers` = 'localhost',\n    `geaflow.dsl.pulsar.port` = '6650',\n    `geaflow.dsl.pulsar.topic` = 'persistent://test/test_pulsar_connector/topic_read',\n    `geaflow.dsl.pulsar.subscriptionInitialPosition` = 'latest'\n    );\nCREATE TABLE pulsar_sink (\n    id BIGINT,\n    name VARCHAR,\n    age INT\n) WITH (\n    type='pulsar',\n    `geaflow.dsl.pulsar.servers` = 'localhost',\n    `geaflow.dsl.pulsar.port` = '6650',\n    `geaflow.dsl.pulsar.topic` = 'persistent://test/test_pulsar_connector/topic_write'\n    );\nINSERT INTO pulsar_sink\nSELECT * FROM pulsar_source;\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b2",children:"\u793a\u4f8b2"}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u6837\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884c\u56db\u5ea6\u73af\u8def\u68c0\u6d4b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"set geaflow.dsl.window.size = 1;\nset geaflow.dsl.ignore.exception = true;\n\nCREATE GRAPH IF NOT EXISTS pulsar_modern (\n  Vertex person (\n    id bigint ID,\n    name varchar\n  ),\n  Edge knows (\n    srcId bigint SOURCE ID,\n    targetId bigint DESTINATION ID,\n    weight double\n  )\n) WITH (storeType='rocksdb',\n  shardCount = 1\n);\n\nCREATE TABLE IF NOT EXISTS pulsar_source (\n    text varchar\n) WITH (\n    type='pulsar',\n    `geaflow.dsl.column.separator` = '#',\n    `geaflow.dsl.pulsar.servers` = 'localhost',\n    `geaflow.dsl.pulsar.port` = '6650',\n    `geaflow.dsl.pulsar.topic` = 'persistent://test/test_pulsar_connector/topic_read',\n    `geaflow.dsl.pulsar.subscriptionInitialPosition` = 'latest'\n    );\n\nCREATE TABLE IF NOT EXISTS pulsar_sink (\n    a_id bigint,\n    b_id bigint,\n    c_id bigint,\n    d_id bigint,\n    a1_id bigint\n) WITH (\n    type='pulsar',\n    `geaflow.dsl.pulsar.servers` = 'localhost',\n    `geaflow.dsl.pulsar.port` = '6650',\n    `geaflow.dsl.pulsar.topic` = 'persistent://test/test_pulsar_connector/topic_write'\n    );\n\nUSE GRAPH pulsar_modern;\n\nINSERT INTO pulsar_modern.person(id, name)\nSELECT\n    cast(trim(split_ex(t1, ',', 0)) as bigint),\n    split_ex(trim(t1), ',', 1)\nFROM (\n    Select trim(substr(text, 2)) as t1\n    FROM pulsar_source\n    WHERE substr(text, 1, 1) = '.'\n    );\n\nINSERT INTO pulsar_modern.knows\nSELECT\n    cast(split_ex(t1, ',', 0) as bigint),\n    cast(split_ex(t1, ',', 1) as bigint),\n    cast(split_ex(t1, ',', 2) as double)\nFROM (\n    Select trim(substr(text, 2)) as t1\n    FROM pulsar_source\n    WHERE substr(text, 1, 1) = '-'\n    );\n\nINSERT INTO pulsar_sink\nSELECT\n    a_id,\n    b_id,\n    c_id,\n    d_id,\n    a1_id\nFROM (\n      MATCH (a:person) -[:knows]->(b:person) -[:knows]-> (c:person)\n          -[:knows]-> (d:person) -> (a:person)\n          RETURN a.id as a_id, b.id as b_id, c.id as c_id, d.id as d_id, a.id as a1_id\n    );\n"})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>i});var t=s(6540);const r={},l=t.createContext(r);function a(n){const e=t.useContext(l);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),t.createElement(l.Provider,{value:e},n.children)}}}]);